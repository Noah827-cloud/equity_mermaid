                                        "child": subsidiary_name,
                                        "percentage": percentage
                                    })
                                
                                imported_count += 1
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
è‚¡æƒç»“æ„æ‰‹åŠ¨ç¼–è¾‘å·¥å…·

æœ¬æ¨¡å—æä¾›æ‰‹åŠ¨æ·»åŠ å…¬å¸ã€è‚¡ä¸œã€å­å…¬å¸åŠå…³ç³»çš„ç•Œé¢ï¼Œç”Ÿæˆä¸å›¾ç‰‡è¯†åˆ«ç›¸åŒæ ¼å¼çš„JSONæ•°æ®ï¼Œ
å¹¶ä½¿ç”¨ç›¸åŒçš„mermaid_functionæ¥ç”Ÿæˆå›¾è¡¨ã€‚
"""

import os
import sys
import json
import streamlit as st
from datetime import datetime
from streamlit_mermaid import st_mermaid
import pathlib

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•åˆ°Pythonè·¯å¾„
sys.path.append(os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__)))))

# è®¾ç½®é¡µé¢é…ç½®
st.set_page_config(
    page_title="è‚¡æƒç»“æ„å›¾ç”Ÿæˆå·¥å…· - æ‰‹åŠ¨ç¼–è¾‘æ¨¡å¼",
    page_icon="ğŸ“Š",
    layout="wide",
    initial_sidebar_state="collapsed"  # é»˜è®¤æŠ˜å ä¾§è¾¹æ 
)

# æ·»åŠ CSSæ ·å¼æ¥éšè—é»˜è®¤çš„å¯¼èˆªå†…å®¹ï¼Œä½†ä¿ç•™è‡ªå®šä¹‰ä¾§è¾¹æ 
st.markdown("""
<style>
    /* è®¾ç½®ä¸»é¢˜å˜é‡ */
    :root {
        --primary-color: #0f4c81;
    }
    
    /* éšè—é»˜è®¤çš„å¯¼èˆªå†…å®¹ */
    [data-testid="stSidebarNav"],[data-testid="stSidebar"] [href*="main_page"],[data-testid="stSidebar"] [href*="1_å›¾åƒè¯†åˆ«æ¨¡å¼"],[data-testid="stSidebar"] [href*="2_æ‰‹åŠ¨ç¼–è¾‘æ¨¡å¼"] {display:none !important;visibility:hidden !important;height:0 !important;width:0 !important;opacity:0 !important;}
    
    /* éšè— sidebar header ä¸Šçš„ keyboard æç¤º */ 
    [data-testid="stSidebar"] .streamlit-expanderHeader button div {display:none !important;}
    
    /* ä¾§è¾¹æ æ•´ä½“èƒŒæ™¯è‰²ä¸å®½åº¦ */ 
    [data-testid="stSidebar"] {
        background-color: var(--primary-color) !important; /* ä½¿ç”¨ä¸»è‰²è°ƒ */ 
        color: #ffffff !important;            /* ç™½è‰²å­—ä½“ */ 
        padding: 1rem 0.5rem;
        min-width: 250px !important;          /* æœ€å°å®½åº¦ */ 
        max-width: 280px !important;          /* æœ€å¤§å®½åº¦ */ 
    }
    
    /* ç¡®ä¿ä¾§è¾¹æ å†…å®¹åŒºåŸŸä¹Ÿä½¿ç”¨ä¸»è‰²è°ƒèƒŒæ™¯ */
    [data-testid="stSidebar"] section,[data-testid="stSidebar"] .sidebar-content {
        background-color: var(--primary-color) !important;
        background: var(--primary-color) !important;
    }
    
    /* Sidebar æ ‡é¢˜ç¾åŒ– */ 
    [data-testid="stSidebar"] h2,[data-testid="stSidebar"] h3 {color:#4fc3f7 !important;font-weight:700 !important;}
    
    /* è®¾ç½®ä¾§è¾¹æ æŒ‰é’®èƒŒæ™¯ä¸ºé€æ˜ */
    [data-testid="stSidebar"] button,[data-testid="stSidebar"] button[data-testid="stBaseButton-secondary"],[data-testid="stSidebar"] [data-testid="stButton"] > button {
        background: transparent !important;
        background-color: transparent !important;
        color: white !important;
        border: none !important;
        box-shadow: none !important;
        opacity: 1 !important;
        background-image: none !important;
        border-radius: 0 !important;
        padding: 0.5rem 1rem !important;
    }
    
    /* ç¡®ä¿æŒ‰é’®å†…çš„æ‰€æœ‰å†…å®¹éƒ½é€æ˜ */
    [data-testid="stSidebar"] button *,[data-testid="stSidebar"] [data-testid="stBaseButton-secondary"] * {
        background-color: transparent !important;
        background: transparent !important;
        box-shadow: none !important;
    }
    
    /* Sidebar å†…æ–‡å­—ç»Ÿä¸€ - é«˜ä¼˜å…ˆçº§ */ 
    [data-testid="stSidebar"] p,
    [data-testid="stSidebar"] label,
    [data-testid="stSidebar"] span {
        color: #e0e0e0 !important;
        font-size: 14px !important;  /* æ·»åŠ !importantç¡®ä¿ä¼˜å…ˆçº§ */
    }
    
    /* ä¾§è¾¹æ å±•å¼€é¢æ¿å†…å®¹çš„æ›´å…·ä½“æ ·å¼æ§åˆ¶ - æœ€é«˜ä¼˜å…ˆçº§ */
    [data-testid="stSidebar"] [data-testid="stExpander"] .streamlit-expanderContent {
        font-size: 14px !important !important;
        color: #e0e0e0 !important !important;
        text-align: left !important !important;
    }
    
    /* ç¡®ä¿å±•å¼€é¢æ¿å†…çš„æ‰€æœ‰æ–‡æœ¬å…ƒç´ éƒ½ä½¿ç”¨ç›¸åŒçš„å­—ä½“å¤§å° - æœ€é«˜ä¼˜å…ˆçº§ */
    [data-testid="stSidebar"] [data-testid="stExpander"] .streamlit-expanderContent * {
        font-size: 14px !important !important;
        color: #e0e0e0 !important !important;
        text-align: left !important !important;
        line-height: 1.4 !important !important;
        font-weight: normal !important !important;
    }
    
    /* é’ˆå¯¹å±•å¼€é¢æ¿å†…ä½¿ç”¨st.write()ç”Ÿæˆçš„å†…å®¹çš„ç‰¹å®šæ ·å¼ */
    [data-testid="stSidebar"] [data-testid="stExpander"] .streamlit-expanderContent p,
    [data-testid="stSidebar"] [data-testid="stExpander"] .streamlit-expanderContent h1,
    [data-testid="stSidebar"] [data-testid="stExpander"] .streamlit-expanderContent h2,
    [data-testid="stSidebar"] [data-testid="stExpander"] .streamlit-expanderContent h3,
    [data-testid="stSidebar"] [data-testid="stExpander"] .streamlit-expanderContent h4,
    [data-testid="stSidebar"] [data-testid="stExpander"] .streamlit-expanderContent h5,
    [data-testid="stSidebar"] [data-testid="stExpander"] .streamlit-expanderContent h6,
    [data-testid="stSidebar"] [data-testid="stExpander"] .streamlit-expanderContent li,
    [data-testid="stSidebar"] [data-testid="stExpander"] .streamlit-expanderContent span {
        font-size: 14px !important !important;
        color: #e0e0e0 !important !important;
