# 更新日志 - 2025年1月17日

## 🎨 主要功能优化

### HTML图表连线样式优化
- **默认直线连线**：将HTML图表的默认连线样式从贝塞尔曲线改为直线，提升图表的简洁性和可读性
- **布局稳定性**：修复隐藏连线后自动刷新布局的问题，保持用户手动调整的节点位置
- **样式一致性**：修复vis.js物理引擎配置，确保连线样式在整个布局过程中保持一致

### 图表类型选择优化
- **默认选择**：设置生成图片时默认选择"交互式HTML图表"，提供更好的用户体验
- **功能丰富**：交互式HTML图表支持拖拽、缩放、高亮等高级交互功能

### 阈值删除功能完善
- **智能实体隐藏**：当隐藏关系时，自动检查并隐藏没有其他关系的孤立实体
- **智能恢复**：恢复关系时，自动检查并恢复有其他关系的实体
- **数据保护**：原始数据完全保留，只是隐藏显示，支持随时恢复

## 🔧 技术修复

### 换行显示优化
- **统一换行符**：HTML图表使用`\n`换行符，Mermaid图表使用`<br>`标签
- **vis.js配置**：将`multi: 'html'`改为`multi: true`，使用原生多行文本支持
- **兼容性提升**：确保在不同浏览器中换行显示一致

### 物理引擎配置优化
- **禁用自动调整**：将所有`fit: true`配置改为`fit: false`
- **用户控制**：用户可以通过"适应"按钮手动调整视图
- **性能优化**：减少不必要的重新渲染，提升图表性能

## 📊 数据过滤增强

### 实时预览过滤
- **关系过滤**：实时预览正确过滤隐藏的股权关系
- **实体过滤**：实时预览正确过滤隐藏的实体和top_entities
- **一致性保证**：确保预览图表与最终图表保持一致

### 图表生成过滤
- **全面过滤**：在所有图表生成路径中应用隐藏关系过滤
- **智能管理**：支持单个和批量恢复被隐藏的关系和实体

## 🐛 问题修复

- 修复HTML图表中`<br>`标签不被支持的问题
- 修复隐藏连线后自动刷新布局的问题
- 修复实时预览中`all_entities`和`top_entities`没有过滤隐藏实体的问题
- 修复vis.js物理引擎`fit: true`覆盖连线样式的问题

## 📈 性能优化

- 减少不必要的网络重新渲染
- 优化连线样式切换性能
- 提升图表加载和交互响应速度

## 🎯 用户体验提升

- 更简洁的直线连线显示
- 更稳定的布局行为
- 更智能的实体管理
- 更一致的数据过滤

---

**版本信息**
- 提交哈希：97d7889
- 更新日期：2025年1月17日
- 影响文件：6个文件修改，1290行新增，527行删除
