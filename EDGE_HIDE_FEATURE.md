# 连线隐藏/删除功能说明

## 新增功能

本次更新为交互式HTML图表添加了**连线（边）的隐藏和删除功能**，与现有的节点隐藏功能保持一致。

## 功能特性

### 1. 右键菜单
- **右键点击连线**：显示连线专用的右键菜单
  - 👁️ 隐藏连线
  - 🗑️ 删除连线

### 2. 隐藏连线管理
在左侧工具栏中新增"🔗 隐藏连线管理"区域，包含：
- **隐藏连线列表**：显示所有已隐藏的连线（显示格式：起点 → 终点 百分比）
- **显示按钮**：点击可恢复显示单条连线
- **显示全部按钮**：一键恢复所有隐藏的连线
- **清空列表按钮**：永久删除所有隐藏的连线

### 3. 操作流程

#### 隐藏连线
1. 右键点击想要隐藏的连线
2. 在弹出菜单中选择"隐藏连线"
3. 连线立即隐藏，并显示提示消息
4. 该连线会出现在"隐藏连线管理"列表中

#### 恢复显示
1. 在左侧工具栏找到"隐藏连线管理"区域
2. 在列表中找到需要恢复的连线
3. 点击该连线右侧的"显示"按钮
4. 连线重新显示在图表中

#### 删除连线
1. 右键点击想要删除的连线
2. 在弹出菜单中选择"删除连线"
3. 确认删除操作
4. 连线永久删除

## 技术实现

### 主要修改文件
- `src/utils/visjs_equity_chart.py`

### 新增内容
1. **HTML结构**
   - 边的右键菜单 (`edgeContextMenu`)
   - 隐藏连线管理区域 (`hiddenEdgesSection`)

2. **JavaScript变量**
   ```javascript
   let contextMenuEdgeId = null;  // 右键菜单对应的边ID
   let hiddenEdges = new Set();   // 隐藏的边ID集合
   let deletedEdges = new Set();  // 删除的边ID集合
   ```

3. **核心函数**
   - `showEdgeContextMenu()` - 显示边的右键菜单
   - `hideEdgeContextMenu()` - 隐藏边的右键菜单
   - `hideEdge()` - 隐藏指定的边
   - `showEdge()` - 显示指定的边
   - `deleteEdge()` - 删除指定的边
   - `showAllHiddenEdges()` - 显示所有隐藏的边
   - `clearHiddenEdgesList()` - 清空隐藏的边列表
   - `updateHiddenEdgesList()` - 更新隐藏边列表显示

4. **事件监听**
   - 扩展了 `network.on('oncontext')` 事件，增加了对边点击的处理
   - 添加了边菜单项的点击事件监听

## 使用场景

1. **简化复杂图表**：临时隐藏不重要的连线，使关键股权关系更加清晰
2. **对比分析**：通过隐藏不同的连线组合，对比不同的股权结构
3. **演示准备**：隐藏某些敏感或不需要展示的股权关系
4. **数据清理**：删除错误或冗余的连线

## 测试文件

提供了独立的测试文件 `test_edge_hide.html`，可以直接在浏览器中打开测试该功能。

## 注意事项

1. 隐藏的连线仅在当前会话中有效，刷新页面后会恢复
2. 删除操作不可撤销，请谨慎使用
3. 清空隐藏列表会永久删除所有隐藏的连线
4. 边的标签（百分比）会显示在隐藏连线列表中，便于识别

## 兼容性

该功能与现有的节点隐藏功能完全兼容，不会相互干扰。

