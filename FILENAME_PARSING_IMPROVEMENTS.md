# 文件名解析功能改进

## 📋 改进内容

### 1. 序号前缀处理
**问题**：文件名如 `2_力诺电力集团股份有限公司.xlsx` 无法正确识别
**解决方案**：使用正则表达式 `r'^\d+_'` 自动移除序号前缀

### 2. 时间戳后缀处理
**问题**：文件名如 `4_力诺集团股份有限公司-对外投资-20251014164519.xlsx` 包含时间戳
**解决方案**：使用正则表达式 `r'-\d{14}$'` 自动移除时间戳后缀

### 3. 智能公司名称识别
**改进**：优先查找包含公司关键词的部分作为实体名称
**关键词列表**：
- 有限公司
- 有限责任公司
- 股份有限公司
- 股份公司
- 集团
- 有限合伙
- 合伙企业
- Co., Ltd., Corp., Inc.

## 🎯 支持的文件名格式

### 股东文件
- `公司名称-股东信息.xlsx`
- `2_公司名称-股东明细.xlsx`
- `公司名称-股东名单-20251014164519.xlsx`

### 对外投资文件
- `公司名称-对外投资.xlsx`
- `4_公司名称-对外投资-20251014164519.xlsx`
- `公司名称-控制企业.xlsx`
- `3_公司名称-子公司-20251015.xlsx`

## ✅ 测试结果

| 文件名 | 识别结果 | 状态 |
|--------|---------|------|
| `4_力诺集团股份有限公司-对外投资-20251014164519.xlsx` | 力诺集团股份有限公司 | ✅ |
| `常州市蓝托金属制品有限公司-对外投资.xlsx` | 常州市蓝托金属制品有限公司 | ✅ |
| `ABC公司-股东信息.xlsx` | ABC公司 | ✅ |
| `3_某某集团有限公司-对外投资-20251015.xlsx` | 某某集团有限公司 | ✅ |
| `5_测试公司股份有限公司-控制企业.xlsx` | 测试公司股份有限公司 | ✅ |

## 🔧 技术实现

### 处理流程
1. 移除文件扩展名
2. 移除序号前缀（`\d+_`）
3. 移除时间戳后缀（`-\d{14}$`）
4. 按分隔符（`-`, `_`, `—`, `－`, `–`）拆分
5. 查找包含公司关键词的部分
6. 清理多余的后缀关键词
7. 返回清理后的公司名称

### 代码位置
- `src/main/manual_equity_editor.py`
  - `_infer_child_from_filename()` - 股东文件解析
  - `_infer_parent_from_filename()` - 投资文件解析
  - `_detect_file_type_from_filename()` - 文件类型检测

## 💡 使用建议

### 文件命名规范
为了获得最佳识别效果，建议使用以下命名格式：

**股东文件**：
```
[序号_]公司全称-股东信息[-时间戳].xlsx
```

**对外投资文件**：
```
[序号_]公司全称-对外投资[-时间戳].xlsx
```

### 示例
- ✅ `1_力诺集团股份有限公司-股东信息-20251014164519.xlsx`
- ✅ `力诺集团股份有限公司-对外投资.xlsx`
- ✅ `2_常州市蓝托金属制品有限公司-控制企业.xlsx`

